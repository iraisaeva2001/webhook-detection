## Описание

Система, имеющая клиент-серверную архитектуру, которая предназначена для обнаружения утечки данных пользователя на сервер Discord через механизм Webhook, используемый в коммуникационных платформах, в результате выполнения вредоносной полезной нагрузки на устройстве жертвы. Данная система на строне сервера перехватывает пакеты и с помощью mitmproxy производит анализ содержания пакетов на соответствие заданным паттернам. В случае совпадения производится уведомление клиента, логирование инцидентов и сохранение подозрительных пакетов для дальнейшего ручного анализа.

## Структура проекта

### [`client/`](https://github.com/iraisaeva2001/webhook-detection/tree/main/client)

Директория содержащая python-скрипт [`client.py`](https://github.com/iraisaeva2001/webhook-detection/blob/main/client/client.py), отвечающая за выполнение клиентской части системы.

- [`client.py`](https://github.com/iraisaeva2001/webhook-detection/blob/main/client/client.py): python-скрипт, исполняемый на стороне клиента, отвечающий за настройку паттернов (добавление, изменение, удаление, активацию, деактивацию паттернов) в виде регулярных выражений и/или ключевых слов, а также имен паттернов, в соответствии с которыми на строне сервера осуществляется анализ перехваченных пакетов, а также передающий серверу команды о запуске sniffer или его остановке.

### [`server/`](https://github.com/iraisaeva2001/webhook-detection/tree/main/server)

Директория содержащая python-скрипты, реализующие работу серверной части системы, а также лог-файлы и файл с сохраненными подозрительными пакетами, полученными в результате инцидентов.

- [`server.py`](https://github.com/iraisaeva2001/webhook-detection/blob/main/server/server.py): python-скрипт, который запускает сервер для анализа сетевого трафика, управляет паттернами фильтрации, запускает сниффинг DNS и HTTPS пакетов, а также интегрируется с mitmproxy для дешифрования HTTPS-трафика.
- [`webhook_detector.py`](https://github.com/iraisaeva2001/webhook-detection/blob/main/server/webhook_detector.py): python-скрипт, который предназначен для мониторинга HTTPS-трафика с использованием mitmproxy. Он проверяет POST-запросы на наличие в URL ключевого слова "Webhook" Discord и сопоставляет содержимое POST-запросов с заранее определенными на стороне клиента паттернами, которые могут содержать чувствительные данные. Если обнаруживается совпадение, скрипт логирует инцидент, отображает уведомление и сохраняет соответствующий сетевой пакет в файл .pcap для дальнейшего ручного анализа.
- [`patterns.txt`](https://github.com/iraisaeva2001/webhook-detection/blob/main/server/patterns.txt): текстовый файл, содержащий список паттернов в виде ключевых слов и/или регулярных выржажений, их имена и состояния активный/неактивный. Файл изменяется в соответствии с настройками паттернов на стороне клиента.
- [`server_logs.txt`](https://github.com/iraisaeva2001/webhook-detection/blob/main/server/server_logs.txt): текстовый файл, логирует события на строне сервера в виде: дата, время, имя события и его содержание. Фиксируемыми событиями являются: подключение/отключение клиента, дабавление/удаление паттернов, запуск/остановка sniffer, список активных паттернов при запуске sniffer, список активных паттернов при запуске mitmproxy. Содержание данного файла обновляется и изменияемся в зависимости от произошедших событий.
- [`incident_logs.txt`](https://github.com/iraisaeva2001/webhook-detection/blob/main/server/incident_logs.txt):текстовый файл, логирует произошедшие инциденты в виде: дата, время, имя инцидента и его содержание. В данном лог-файле фиксируется следующая информация об инциденте: список активных паттернов в момент инцидента, отправка уведомления об инциденте клиенту, обнаруженная в пакете информация и его сохранение. Содержание данного файла обновляется и изменияемся в зависимости от произошедших инцидентов.
- [`matched_packets.pcap`](https://github.com/iraisaeva2001/webhook-detection/blob/main/server/matched_packets.pcap): файл в формате .pcap, в котором содержатся пакеты с обнаруженными совпадениями на основе ключевых слов и/или регулярных выражений в момент инцидента.

### [`Discord_token_grabber/`](https://github.com/iraisaeva2001/webhook-detection/tree/main/Discord_token_grabber)

Директория содержащая тестовый Discord token grabber, который реализует утечку данных пользователя через механизм Webhook на сервер Discord.
